<!DOCTYPE html>
<html lang="en">
<head>
    <include file="Public:header" />

    <!-- this page specific styles -->
    <link rel="stylesheet" href="__PUBLIC__/Main/css/product-list.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="__VD__/jqPagination/css/jqpagination.css" media="all" type="text/css" />
</head>
<style>
    .pd-img{
        height: 200px;
        width: 200px;
    }

    .search {
        width: 100px;
        padding: 1px 5px;
        border-radius: 3px;
        border:1px solid #bbb;
    }

    .search-list {
        margin: 10px 5px 20px 5px;
    }
</style>

<body>
<div class="container product-list" style="max-width: 1050px;">
    <include file="Public:main_nav" />

    <div class="row row-offcanvas row-offcanvas-right">
        <div class="col-xs-12 col-sm-10">
            <form id="form_sch">
                <div class="search-list">
                    <dl >
                        <dt>Name</dt>
                        <input id="name" type="text" class="search" placeholder="type name" value="">
                        <a class="btn-flat primary pull-right" id="btn_search">Search</a>
                    </dl>
                    <dl >
                        <dt>Code</dt>
                        <input id="code" type="text" class="search" placeholder="type code" value="">
                    </dl>
                    <dl>
                        <dt>Size</dt>
                        <select id="size">

                        </select>
                    </dl>
                    <dl>
                        <dt>Category</dt>
                        <select id="category">

                        </select>
                    </dl>
                    <dl>
                        <dt>Type</dt>
                        <select id="type">

                        </select>
                    </dl>
                </div>
            </form>

            <!-- Product table -->
            <table class="table table-hover" id="product_list">
                <thead>
                <tr>
                    <th class="sortable">
                        Product
                    </th>
                    <th class="sortable">
                        <span class="line"></span>Size
                    </th>
                    <th class="sortable">
                        <span class="line"></span>Category
                    </th>
                    <th class="sortable">
                        <span class="line"></span>Type
                    </th>
                    <th class="sortable">
                        <span class="line"></span>Price
                    </th>
                    <th class="sortable">
                        <span class="line"></span>Manufacturer
                    </th>
                    <th class="sortable">
                        <span class="line"></span>Origin
                    </th>
                </tr>
                </thead>
                <tbody id="list_content">

                </tbody>
            </table>
            <!-- end Product table -->
            <div style="margin: 20px 0;display: inline-block;">
                <label>Show </label>
                <select id="list-rows" aria-controls="user-list" class="">
                    <option value="10">10</option>
                    <option value="25">25</option>
                    <option value="50">50</option>
                    <option value="100">100</option>
                </select>
                <label>entries</label>
            </div>
            <div class="pagination pull-right">
                <a href="#" class="first" data-action="first">&laquo;</a>
                <a href="#" class="previous" data-action="previous">&lsaquo;</a>
                <input type="text" readonly="readonly" data-max-page="40" />
                <a href="#" class="next" data-action="next">&rsaquo;</a>
                <a href="#" class="last" data-action="last">&raquo;</a>
            </div>

        </div><!--/.col-xs-12.col-sm-10-->

        <include file="Public:righter"/>
    </div><!--/row-->

    <include file="Public:footer" />
</div><!--/.container-->


<include file="Public:js_basic" />
<script src="__VD__/jqPagination/js/jquery.jqpagination.js" type="text/javascript"></script>
<script>
    $(function(){
        initConfig();

        //auto loading
        loadList(1,1);

        //event
        $('#btn_search').click(function(){
            loadList(1,0);
        });

        $("#list-rows").change(function(){
            loadList(1,1);
        })
    })

    function initConfig(){
        $.ajax({
            type: "post",
            url: "__URL__/ajaxConf",
            success: function (rtn){
                if(rtn.status){
                    $.each(rtn.list,function(index,value){
                        var element = "#" + index;
                        var html = '<option value="">--</option>';
                        $.each(value,function(index,value){
                            html+= '<option value="'+ index +'">'+ value + '</option>';
                        })

                        $(element).append(html);
                    })
                }else{
                    alert(rtn.info);
                }
            }
        });
    }

    function loadList(page,auto){
        if(auto == 1){
            var keyword = getUrlParameter('key');
            if(keyword == undefined){
                keyword = '';
            }
            $("#keyword").val(keyword);
        }

        var _keyword = $("#keyword").val();
        var _type = $("#type").val();
        var _cate = $('#category').val();
        var _size = $("#size").val();
        var _listRows = $("#list-rows").val();

        $.ajax({
            type: "POST",
            url: "__URL__/searchList",
            data: {keyword:_keyword,type:_type, category:_cate,size:_size,page:page,listRows:_listRows},
            dataType: "json",
            success: function(data){
                if(data.status){
                    var item = data.list;
                    var $content = $('#list_content');
                    $content.empty();
                    var html = '';
                    if(false == item){
                        var colspan = $("#product_list th").length;
                        html += '<tr><td colspan="'+ colspan +'" style="text-align: center;color: #999;">No matching records found</td></tr>';
                    }else{
                        for(var i=0;i<item.length;i++){
                            html+='<tr>';
                            html+='<td><img src="'+item[i]['image']+'" class="img-circle avatar hidden-phone" />';
                            html+='<a href="user-profile.html" class="name">'+item[i]['name']+'</a>';
                            html+='<span class="subtext">'+item[i]['code']+'</span>';

                            html+="<td>"+item[i]['size']+"</td>";
                            html+="<td>"+item[i]['category']+"</td>";
                            html+="<td>"+item[i]['type']+"</td>";
                            html+='<td>CNY:&yen;'+item[i]['price_cn']+'<span class="subtext"><br/> KRW:&#8361;'+item[i]['price_kr']+'</span></td>';
                            html+="<td>"+item[i]['manufacturer']+"</td>";
                            html+="<td>"+item[i]['origin']+"</td>";
                            html+="</tr>";
                        }
                    }
                    $content.append(html);

                    //pagination
                    $('.pagination').jqPagination({
                        max_page:data.max_page,
                        paged: function(page) {
                            // do something with the page variable
                            loadList(page);
                        }
                    });
                }else{
                    alert(data.msg);
                }
            }
        });
    }
</script>
</body>
</html>
